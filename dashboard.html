<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study Tracker</title>

<link rel="stylesheet" href="static/style.css">
<link rel="manifest" href="static/manifest.json">
<link rel="icon" href="static/favicon.ico">
<meta name="theme-color" content="#0b1f5e">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Firebase (MUST be before JS usage) -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCYuhNhB-i-NxjenRFjdzugYOsw2KeXSq0",
    authDomain: "study-tracker1.firebaseapp.com",
    projectId: "study-tracker1",
    messagingSenderId: "210271104714",
    appId: "1:210271104714:web:14ec55de6895019822ce33"
  };
  firebase.initializeApp(firebaseConfig);
</script>
</head>

<body>

<h2>ğŸ“Š TCS 15-Day Study Tracker</h2>

<div class="info-banner">
  ğŸ”” <strong>Push notifications supported</strong>
  <button onclick="enablePush()" class="reset-btn">
    ğŸ”” Enable Push Notifications
  </button>
</div>

<div class="chart-container">
  <canvas id="chart"></canvas>
</div>

<div id="alertBox" class="browser-alert" style="display:none;"></div>
<div style="text-align:center;margin:12px 0;">
  <button class="reset-today-btn" onclick="resetToday()">ğŸ” Reset Today</button>
  <button class="reset-btn" onclick="resetAll()">ğŸ”„ Reset 15-Day Plan</button>

  <select id="daySelect"></select>
  <button class="reset-day-btn" onclick="resetSelected()">ğŸ” Reset Selected Day</button>

  <button class="undo-btn" onclick="undoReset()">â†© Undo Last Reset</button>
</div>

<table>
  <thead>
    <tr>
      <th>Day</th>
      <th>Task</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="taskTable"></tbody>
</table>

<h3 id="weeklyProgress"></h3>

<audio id="alertSound" src="static/alert.mp3"></audio>

<!-- Push Notification Logic -->
<script>
  const messaging = firebase.messaging();

  function enablePush() {
    Notification.requestPermission().then(permission => {
      if (permission !== "granted") {
        alert("Notification permission denied");
        return;
      }

      messaging.getToken({
        vapidKey: "BParGCjnABsB3lo5eqhOhm2vZqvFsF8D8RCY-Mu3QSeAXEoWzhiR0Ua_ukBOv20BfjrZBnw3tDcpj38dRjCNw"
      }).then(token => {
        console.log("ğŸ”¥ FCM TOKEN:", token);
        alert("Push notifications enabled!");
      }).catch(err => {
        console.error("FCM error:", err);
      });
    });
  }

  messaging.onMessage(payload => {
    new Notification(payload.notification.title, {
      body: payload.notification.body,
      icon: "static/icon-192.png"
    });
  });
</script>

<!-- Your static dashboard logic -->
<script src="static/dashboard.js"></script>

</body>
</html>

